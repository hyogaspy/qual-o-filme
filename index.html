<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cinedle - Adivinhe o Filme</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #0f0f0f; color: white; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        input { padding: 12px; width: 300px; border-radius: 5px; border: 1px solid #333; background: #1a1a1a; color: white; margin-bottom: 10px; }
        button { padding: 12px 25px; border-radius: 5px; background: #e50914; color: white; border: none; cursor: pointer; font-weight: bold; }
        
        /* Estilo da Tabela de Resultados */
        .resultado-header { display: grid; grid-template-columns: 2fr 1fr 1.5fr 1.5fr 2fr; gap: 10px; font-weight: bold; margin-bottom: 10px; border-bottom: 2px solid #333; padding-bottom: 5px; }
        .movie-row { display: grid; grid-template-columns: 2fr 1fr 1.5fr 1.5fr 2fr; gap: 10px; margin-bottom: 10px; animation: slideIn 0.4s ease-out; }
        
        .box { 
            background: #1e1e1e; padding: 10px; border-radius: 4px; display: flex; 
            align-items: center; justify-content: center; font-size: 13px; text-align: center;
            min-height: 50px; border: 1px solid #333;
        }

        /* Cores de Acerto/Erro */
        .correct { background-color: #2e7d32 !important; border-color: #4caf50; }
        .wrong { background-color: #c62828 !important; border-color: #f44336; }
        .partial { background-color: #f9a825 !important; border-color: #fbc02d; } /* Para elenco parcialmente correto */

        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body>

<div class="container">
    <h1>Cinedle ðŸŽ¬</h1>
    <p>Compare as categorias para achar o filme secreto</p>

    <input type="text" id="inputFilme" list="sugestoes" placeholder="Digite o nome de um filme..." oninput="buscarSugestoes()">
    <datalist id="sugestoes"></datalist>
    <button onclick="fazerPalpite()">Chutar</button>

    <div style="margin-top: 30px;">
        <div class="resultado-header">
            <div>TÃ­tulo</div>
            <div>Ano</div>
            <div>Diretor</div>
            <div>Roteiro</div>
            <div>Elenco</div>
        </div>
        <div id="listaResultados"></div>
    </div>
</div>

<script>
    const API_KEY = '7b13c115c103f83a94753fd427244996';
    
    // FILME SECRETO (Aqui vocÃª define qual o filme o jogador deve adivinhar)
    // DICA: VocÃª pode automatizar isso no futuro para ser um filme aleatÃ³rio
    const FILME_SECRETO = {
        id: 157336, // ID do Interstellar no TMDB
        title: "Interestelar",
        year: 2014,
        director: "Christopher Nolan",
        writer: "Jonathan Nolan",
        cast: ["Matthew McConaughey", "Anne Hathaway", "Jessica Chastain"]
    };

    async function buscarSugestoes() {
        const query = document.getElementById('inputFilme').value;
        if (query.length < 3) return;
        const resp = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&query=${encodeURIComponent(query)}&language=pt-BR`);
        const data = await resp.json();
        const datalist = document.getElementById('sugestoes');
        datalist.innerHTML = '';
        data.results.slice(0, 6).forEach(f => {
            const option = document.createElement('option');
            option.value = f.title;
            datalist.appendChild(option);
        });
    }

    async function obterDetalhesFilme(movie_id) {
        const resp = await fetch(`https://api.themoviedb.org/3/movie/${movie_id}?api_key=${API_KEY}&append_to_response=credits&language=pt-BR`);
        const data = await resp.json();
        
        const director = data.credits.crew.find(person => person.job === 'Director')?.name || "N/A";
        const writer = data.credits.crew.find(person => person.job === 'Screenplay' || person.job === 'Writer')?.name || "N/A";
        const cast = data.credits.cast.slice(0, 3).map(c => c.name); // Pega os 3 principais atores

        return {
            title: data.title,
            year: parseInt(data.release_date.split('-')[0]),
            director: director,
            writer: writer,
            cast: cast
        };
    }

    async function fazerPalpite() {
        const input = document.getElementById('inputFilme');
        const nome = input.value;
        if(!nome) return;

        const searchResp = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&query=${encodeURIComponent(nome)}&language=pt-BR`);
        const searchData = await searchResp.json();
        const baseFilme = searchData.results[0];

        if (baseFilme) {
            const chute = await obterDetalhesFilme(baseFilme.id);
            input.value = '';
            compararEExibir(chute);
        }
    }

    function compararEExibir(chute) {
        const lista = document.getElementById('listaResultados');
        const row = document.createElement('div');
        row.className = 'movie-row';

        // LÃ³gica de ComparaÃ§Ã£o
        const cAno = chute.year === FILME_SECRETO.year ? 'correct' : 'wrong';
        const setaAno = chute.year < FILME_SECRETO.year ? ' â¬†ï¸' : (chute.year > FILME_SECRETO.year ? ' â¬‡ï¸' : '');
        
        const cDir = chute.director === FILME_SECRETO.director ? 'correct' : 'wrong';
        const cWrit = chute.writer === FILME_SECRETO.writer ? 'correct' : 'wrong';
        
        // Elenco: Verde se acertar os 3, Amarelo se tiver pelo menos 1 igual
        const atoresComuns = chute.cast.filter(ator => FILME_SECRETO.cast.includes(ator));
        let cCast = 'wrong';
        if (atoresComuns.length === FILME_SECRETO.cast.length) cCast = 'correct';
        else if (atoresComuns.length > 0) cCast = 'partial';

        row.innerHTML = `
            <div class="box">${chute.title}</div>
            <div class="box ${cAno}">${chute.year}${setaAno}</div>
            <div class="box ${cDir}">${chute.director}</div>
            <div class="box ${cWrit}">${chute.writer}</div>
            <div class="box ${cCast}">${chute.cast.join(', ')}</div>
        `;

        lista.insertBefore(row, lista.firstChild);

        if (chute.title === FILME_SECRETO.title) {
            setTimeout(() => alert("ðŸŽ‰ VocÃª mita no cinema! Acertou!"), 500);
        }
    }
</script>

</body>
</html>
